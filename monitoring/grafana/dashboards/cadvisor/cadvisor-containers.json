{
  "title": "cAdvisor - Containers Overview",
  "uid": "cadvisor-overview",
  "schemaVersion": 39,
  "version": 1,
  "tags": ["cadvisor", "containers"],
  "time": {"from": "now-6h", "to": "now"},
  "templating": {
    "list": [
      {
        "name": "prom",
        "label": "Prometheus DS",
        "type": "datasource",
        "query": "prometheus",
        "current": {"text": "VictoriaMetrics", "value": "VictoriaMetrics"},
        "options": []
      },
      {
        "name": "container",
        "label": "Container",
        "type": "query",
        "datasource": {"type": "prometheus", "uid": "${prom}"},
        "query": "label_values(container_cpu_usage_seconds_total, container)",
        "refresh": 1,
        "includeAll": true,
        "multi": true,
        "current": {"text": "All", "value": "$__all"}
      }
    ]
  },
  "panels": [
    {
      "type": "timeseries",
      "title": "CPU Usage (cores) by Container",
      "gridPos": {"x": 0, "y": 0, "w": 12, "h": 8},
      "datasource": {"type": "prometheus", "uid": "${prom}"},
      "targets": [
        {"expr": "sum(rate(container_cpu_usage_seconds_total{container=~\"$container\"}[1m])) by (container)", "legendFormat": "{{container}}"}
      ]
    },
    {
      "type": "timeseries",
      "title": "Memory Usage (bytes) by Container",
      "gridPos": {"x": 12, "y": 0, "w": 12, "h": 8},
      "datasource": {"type": "prometheus", "uid": "${prom}"},
      "targets": [
        {"expr": "max(container_memory_usage_bytes{container=~\"$container\"}) by (container)", "legendFormat": "{{container}}"}
      ],
      "options": {"fieldOptions": {"defaults": {"unit": "bytes"}}}
    },
    {
      "type": "timeseries",
      "title": "Network I/O (bytes/sec)",
      "gridPos": {"x": 0, "y": 8, "w": 12, "h": 8},
      "datasource": {"type": "prometheus", "uid": "${prom}"},
      "targets": [
        {"expr": "sum(rate(container_network_receive_bytes_total{container=~\"$container\"}[1m])) by (container)", "legendFormat": "recv {{container}}"},
        {"expr": "sum(rate(container_network_transmit_bytes_total{container=~\"$container\"}[1m])) by (container)", "legendFormat": "sent {{container}}"}
      ]
    },
    {
      "type": "timeseries",
      "title": "Disk I/O (bytes/sec)",
      "gridPos": {"x": 12, "y": 8, "w": 12, "h": 8},
      "datasource": {"type": "prometheus", "uid": "${prom}"},
      "targets": [
        {"expr": "sum(rate(container_fs_reads_bytes_total{container=~\"$container\"}[1m])) by (container)", "legendFormat": "read {{container}}"},
        {"expr": "sum(rate(container_fs_writes_bytes_total{container=~\"$container\"}[1m])) by (container)", "legendFormat": "write {{container}}"}
      ]
    },
    {
      "type": "table",
      "title": "Top Containers by CPU (1m rate)",
      "gridPos": {"x": 0, "y": 16, "w": 12, "h": 7},
      "datasource": {"type": "prometheus", "uid": "${prom}"},
      "targets": [
        {"expr": "topk(10, sum(rate(container_cpu_usage_seconds_total[1m])) by (container))", "format": "table", "instant": true}
      ]
    },
    {
      "type": "table",
      "title": "Top Containers by Memory",
      "gridPos": {"x": 12, "y": 16, "w": 12, "h": 7},
      "datasource": {"type": "prometheus", "uid": "${prom}"},
      "targets": [
        {"expr": "topk(10, max(container_memory_usage_bytes) by (container))", "format": "table", "instant": true}
      ],
      "options": {"fieldOptions": {"defaults": {"unit": "bytes"}}}
    }
  ]
}
